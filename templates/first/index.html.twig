{% extends 'base.html.twig' %}

{% block title %}Hello FirstController!{% endblock %}

{% block body %}
<style>
    .example-wrapper { margin: 1em auto; max-width: 800px; width: 95%; font: 18px/1.5 sans-serif; }
    .example-wrapper code { background: #F5F5F5; padding: 2px 6px; }
</style>

<div class="example-wrapper">
    <h1>Search for a Ship</h1>
    <form>
        <input type="text" id="ship-search" placeholder="Type a ship name">
    </form>
    <h1>Hello {{ controller_name }}! âœ…</h1>

    This friendly message is coming from:
    <ul>
        <li>Your controller at <code>D:/_DEV/starHQ/src/Controller/FirstController.php</code></li>
        <li>Your template at <code>D:/_DEV/starHQ/templates/first/index.html.twig</code></li>
        {% for test in tests %}
            {# comment #}
            <li> {{test}} </li>
        {% endfor %}
        {{ author }}

        <img src="{{ asset('images/2020-12-19 18_55_09-Twitch.png') }}">

    </ul>
</div>


<script>
    // autocomplete feature
    $(function() {
        $("#ship-search").autocomplete({
            source: function(request, response) {
                $.ajax({
                    url: "{{ path('api_ships') }}",
                    data: {
                        q: request.term
                    },
                    success: function(data) {
                        response(data);
                    },
                    error: function() {
                        response([]);
                    }
                });
            },
            minLength: 2
        });

        // Redirect when Enter key is pressed
        $("#ship-search").on("keypress", function(event) {
            if (event.which === 13) { // 13 is the Enter key code
                // Get the selected ship name
                var selectedShip = $(this).val();
                
                // Redirect to the ship page
                window.location.href = "{{ path('ship_page') }}?name=" + encodeURIComponent(selectedShip);
            }
        });
    });
</script>
{% endblock %}
